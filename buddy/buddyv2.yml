- pipeline: "Pipeline_UpdateAvada"
  on: "CLICK"
  refs:
  - ":default"
  fail_on_prepare_env_warning: true
  actions:
  - action: "[\t185.151.30.193] Execute rm -rf $TARGET_DIR"
    type: "SSH_COMMAND"
    login: "landstack.io"
    password: "secure!y8EVoTOE1VkGBx/QyD2emQ==.n4QZyhoUhRKSgkQVfP27og=="
    host: "ftp.us.stackcp.com"
    commands:
    - "#!/bin/bash"
    - ""
    - "# Variables"
    - "SOURCE_DIR=\"/test1\""
    - "TARGET_REPO=\"git@github.com:jecci/Avada.git\""
    - "TARGET_DIR=\"/tmp/Avada\"  # Updated with example username"
    - "TARGET_SUBDIR=\"20i\""
    - ""
    - "# Clean up any previous clone"
    - "rm -rf $TARGET_DIR"
    - ""
    - "# Clone the target repository"
    - "git clone $TARGET_REPO $TARGET_DIR"
    - ""
    - "# Create the target subdirectory if it doesn't exist"
    - "mkdir -p $TARGET_DIR/$TARGET_SUBDIR"
    - ""
    - "# Copy the specific directory to the target subdirectory in the cloned repository"
    - "rsync -av --delete $SOURCE_DIR/ $TARGET_DIR/$TARGET_SUBDIR/"
    - ""
    - "# Navigate to the cloned repository"
    - "cd $TARGET_DIR"
    - ""
    - "# Commit and push the changes"
    - "git add ."
    - "git commit -m \"Automated commit of files from web server\""
    - "git push origin main"
    - ""
    - "# Clean up"
    - "cd .."
    - "rm -rf $TARGET_DIR"
    run_as_script: true
  - action: "FTP to Test1"
    type: "FTP"
    disabled: true
    local_path: "/Plugins/"
    remote_path: "/test1/"
    login: "landstack.io"
    password: "secure!y8EVoTOE1VkGBx/QyD2emQ==.n4QZyhoUhRKSgkQVfP27og=="
    host: "ftp.us.stackcp.com"
  - action: "FTP to Test2_baby"
    type: "FTP"
    disabled: true
    local_path: "/Plugins/"
    remote_path: "/test2/baby/"
    login: "landstack.io"
    password: "secure!y8EVoTOE1VkGBx/QyD2emQ==.n4QZyhoUhRKSgkQVfP27og=="
    host: "ftp.us.stackcp.com"
